# The Croupier bot

---

The Croupier bot - это игровой бот, в котором реализована 
механика карточной игры BlackJack с разными вариациями(ставки, замена карт, автосумма очков).

Бот построен по следующей иерархии:

* Игра Blakjack
  * Раздача карт и ставка (если включена)
  * Механика самой игры
  * Выход или продолжение игры
* Настройка игры
  * Настройка ставкок, автосуммы, карт и пополнение баланса
  * В каждой вкладке есть выбор между кнопкой "включить" или "выключить"

---

### Изначально бот предалагает на выбор три действия:

![Screen_1](https://user-images.githubusercontent.com/98232785/210860314-b9e9df8d-0b08-4375-b82c-bfed0de2288c.png)


* *Настройки - Переход на страницу настроек игры
* О боте - Краткая информация о боте
* Blackjack - Запуск игры

## Игра Blackjack

При запуске игры активируется скрипт который выдает игроку случайную карту:

```python
for i in range(2):      #бот раздает две карты себе и игроку
    giveRandomCard(bjData.userCard, bjData.botCard)     #записывает карту в объект игрока и сравнивает со своим
    giveRandomCard(bjData.botCard, bjData.userCard)     #записывает карту в свой объект и сравнивает с игроком
                                                        #сравнение нужно для проверки дубликатов
```

![Screen_2](https://user-images.githubusercontent.com/98232785/210860489-042aaa59-6c0f-4544-8bd7-5d64118d1d43.png)


Дальше есть вариация ходов:

### Выход

При нажатии на кнопку выхода, запускается скрипт, который чистит все данные о последних играх.
Если игра была со ставками, то бот проверяет, вышел ли игрок в процессе или по окончании игры.
Это нужно для того, чтобы баланс игрока не менялся, если он вышел до окончания игры.


```python
@bot.message_handler(func=lambda message: message.text == commands.exitGame)  #слушатель кнопки выход
def leaveGame(message): 
    if mainData.whereUser == mainData.sections["bj"]:               #проверка того, что игрок находится в игре
        if bjData.gameRate != 0:                                    #Если ставка есть
            bjData.balance = bjData.balance + bjData.gameRate       #Мы к балансу прибавляем цену ставки
            bjData.gameRate = 0                                     #Обнуляем цену игровой ставки
        repository.quitOrRebootGame(True)                           #Очищаем данные прошлой игры
        mainRepository.goMenu(message)                              #Возвращаем игрока в меню
```

